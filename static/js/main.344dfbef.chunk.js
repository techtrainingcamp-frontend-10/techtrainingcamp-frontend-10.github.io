(this["webpackJsonpmy-tiktok"]=this["webpackJsonpmy-tiktok"]||[]).push([[0],{114:function(e,t,a){e.exports={live:"LivePlayer_live__fkY4j",info:"LivePlayer_info__3914u",liveComents:"LivePlayer_liveComents__DLU61",input:"LivePlayer_input__3pqNN"}},115:function(e,t,a){e.exports={top:"Top_top__31tH1",right:"Top_right__mXSyQ","close-btn":"Top_close-btn__2NGeS"}},124:function(e,t,a){e.exports={like:"Like_like__3MFlF","like-icon":"Like_like-icon__12-Nh",liked:"Like_liked__3TB8c","like-number":"Like_like-number__I12bo"}},224:function(e,t,a){},249:function(e,t,a){},250:function(e,t,a){},262:function(e,t,a){},333:function(e,t,a){},338:function(e,t,a){},339:function(e,t,a){},340:function(e,t,a){},341:function(e,t,a){"use strict";a.r(t);var n=a(3),s=a(0),i=a.n(s),c=a(30),r=a.n(c),o=(a(224),a(67)),l=a(40),d=function(){return localStorage.getItem("userToken")},u=function(e){localStorage.setItem("userToken",e)},m=function(){return localStorage.getItem("userID")},h=function(e){localStorage.setItem("userID",e)};var j=function(e){return d()&&m()?Object(n.jsx)(l.b,{exact:e.exact,path:e.path,component:e.component}):Object(n.jsx)(l.a,{to:"/ucenter"})},p=a(53),b=a.n(p),v=a(74),g=a(104),f=a(22),O=a(23),x=a(25),k=a(24),y=a(71),w=a.n(y);w.a.defaults.baseURL="https://qcmt57.fn.thelarkcloud.com",w.a.interceptors.request.use((function(e){var t=m(),a=d();return t&&a&&(e.data||(e.data={}),e.data.userId=parseInt(t,10),e.data.token=a),e}),(function(e){return Promise.reject(e)})),w.a.interceptors.response.use((function(e){return e}),(function(e){return Promise.reject(e)}));var C=w.a,N=function(e){return C.post("/like",e)},S=a(39),I=a(61),_=a.n(I),L=a(77),P=a(168),T=a.n(P),U=a(197),D=a.n(U),B=(a(249),a(5)),V=a.n(B),F=function(e){Object(x.a)(a,e);var t=Object(k.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).player=void 0,n.state={dmkList:[]},e.onRef&&e.onRef(Object(L.a)(n)),n}return Object(O.a)(a,[{key:"initPlayer",value:function(){var e=this,t=this.props,a=t.type,n=t.id,s=t._id,i=t.url;console.log("start"),console.log(this.state.dmkList),"video"===a?(this.player=new T.a({id:"".concat(a).concat(n),width:window.innerWidth,height:window.innerHeight,url:i,autoplay:!0,videoInit:!0,"x5-video-player-type":"h5",playsinline:!1,loop:!0,closeVideoStopPropagation:!0,closePlayVideoFocus:!0,ignores:["time","definition","error","fullscreen","i18n","pc","play","replay","volume"],danmu:{comments:this.state.dmkList,area:{start:.3,end:1}}}),this.initDmk(s,this.player),this.player.on("timeupdate",(function(t){e.props.onTimeChange(Math.round(1e3*parseFloat(t.maxPlayedTime)))}))):"live"===a&&(this.player=new D.a({id:"".concat(a).concat(n),width:window.innerWidth,height:window.innerHeight,url:i,autoplay:!0,videoInit:!0,controls:!1,"x5-video-player-type":"h5",playsinline:!1,closeVideoStopPropagation:!0,closePlayVideoFocus:!0,ignores:["time","definition","error","fullscreen","i18n","loading","mobile","pc","play","poster","progress","replay","volume"]})),console.log("[".concat(n,"] Player inited."),this.player)}},{key:"initDmk",value:function(e,t){var a=this;w.a.post("https://qcmt57.fn.thelarkcloud.com/getDanmuku",{vedioId:e}).then((function(e){console.log(e.data.dmkList),a.setState({dmkList:e.data.dmkList}),e.data.dmkList.forEach((function(e){t.danmu.sendComment(e)}))})).catch((function(e){return console.log(e)}))}},{key:"appendDmk",value:function(e){var t;console.log("getDMK:",e),null===(t=this.player)||void 0===t||t.danmu.sendComment(e)}},{key:"componentDidMount",value:function(){this.props.active&&this.initPlayer()}},{key:"componentDidUpdate",value:function(){var e=this.props,t=e.id;e.active?this.player||this.initPlayer():this.player&&(this.player.destroy(),delete this.player,console.log("[".concat(t,"] Player destroyed."),this.player))}},{key:"render",value:function(){var e=this.props,t=e.id,a=e.type;return Object(n.jsx)("div",{className:V()("player",{"player-video":"video"===a,"player-live":"live"===a}),children:Object(n.jsx)("div",{id:"".concat(a).concat(t)})})}}]),a}(i.a.Component),R=a(51),M=a(361),E=(a(250),a(198)),q=a.n(E),z=function(e){return C.post("/getComment",e)},W=function(e){return C.post("/likeComment",e)},A=function(e){return C.post("/getCommentLive",e)},Z=function(e){Object(x.a)(a,e);var t=Object(k.a)(a);function a(){return Object(f.a)(this,a),t.apply(this,arguments)}return Object(O.a)(a,[{key:"render",value:function(){return Object(n.jsxs)("div",{className:"vlive-comment-item-wrapper",children:[Object(n.jsx)("span",{className:"vlive-comment-item-uname",children:this.props.pname}),this.props.content]})}}]),a}(i.a.Component),G=function(e){Object(x.a)(a,e);var t=Object(k.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).demoo={id:"name",content:"ikuikuikuikuikuikuikuikuikuikuikuikuikuikuikuikuikuikuikuikuikuikuikuikuikuikuikuikuikuikuikuiku",pname:"11",ptime:"1",like:!1,avatar:"s",likeCount:1},n.demomo=[n.demoo],n.wrapper=void 0,n.interval=0,n.scrollToBottom=function(){var e=document.getElementById("messagesEndRef");null===e||void 0===e||e.scrollIntoView({behavior:"smooth"})},n.handleTap=function(e){var t,a,s,i=null===(t=n.wrapper)||void 0===t?void 0:t.clientHeight,c=null===(a=n.wrapper)||void 0===a?void 0:a.scrollHeight,r=null===(s=n.wrapper)||void 0===s?void 0:s.scrollTop,o=!(i&&r&&c&&c>i&&i+r===c);n.setState({isPause:o})},n.state={displayIndex:0,bufferSize:2,displayComents:[],allComments:[],isPause:!1},n}return Object(O.a)(a,[{key:"componentDidMount",value:function(){var e=this;"video"===this.props.type&&(this.fetchComments({videoId:this.props.id}),setInterval((function(){if(!e.state.isPause){var t=e.state.displayComents;e.state.displayIndex-e.state.bufferSize>=0&&delete t[e.state.displayIndex-e.state.bufferSize];var a=e.state.allComments[e.state.displayIndex%e.state.allComments.length];a&&e.setState({displayComents:t.concat(a),displayIndex:e.state.displayIndex+1})}}),1500)),"live"===this.props.type&&(this.fetchCommentsLive({videoId:this.props.id}),this.interval=window.setInterval((function(){e.fetchCommentsLive({videoId:e.props.id})}),2e3))}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"fetchComments",value:function(e){var t=this;"video"===this.props.type&&z({videoId:e.videoId}).then((function(e){var a=e.data;a.success&&(a=(a=a.data).map((function(e){var t;return{id:e._id,avatar:"null",pname:null===e||void 0===e||null===(t=e.userItem)||void 0===t?void 0:t.userName,ptime:e.createdAt.toString(),likeCount:e.liked,like:!1,content:e.comment}})),t.setState({allComments:a}))})).catch((function(e){console.log(e)}))}},{key:"fetchCommentsLive",value:function(){var e=Object(v.a)(b.a.mark((function e(t){var a,n,s,i,c,r=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A({videoId:t.videoId});case 3:if(a=e.sent,(n=a.data).success){e.next=7;break}return e.abrupt("return");case 7:if(n=(n=n.data).map((function(e){var t;return{id:e._id,avatar:"null",pname:null===e||void 0===e||null===(t=e.userItem)||void 0===t?void 0:t.userName,ptime:e.createdAt.toString(),likeCount:e.liked,like:!1,content:e.comment}})),this.setState({allComments:n}),0!==n.length){e.next=12;break}return e.abrupt("return");case 12:if(!(0===this.state.displayComents.length&&n.length>0)){e.next=15;break}return this.setState({displayComents:n.slice(-2)}),e.abrupt("return");case 15:if(s=n.findIndex((function(e){return e.id===r.state.displayComents[r.state.displayComents.length-1].id})),this.state.displayComents.length>0&&s<n.length-1){for(this.setState({displayComents:this.state.displayComents.concat(n.slice(-(n.length-s-1)))}),i=this.state.displayComents,c=0;c<i.length-2;c++)delete i[c];this.setState({displayComents:i}),console.log(this.state)}e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),console.log(e.t0);case 22:case"end":return e.stop()}}),e,this,[[0,19]])})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(n.jsx)("div",{className:"vlive-comment-wrapper",onTouchEnd:this.handleTap,ref:function(t){e.wrapper=t},children:Object(n.jsxs)(q.a,{transitionName:"example",transitionEnterTimeout:500,transitionLeaveTimeout:500,children:[this.state.displayComents.map((function(e,t){return Object(s.createElement)(Z,Object(S.a)(Object(S.a)({},e),{},{key:t}))})),Object(n.jsx)("div",{id:"messagesEndRef"})]})})}}]),a}(i.a.Component),H=(a(262),a(355)),J=a(352),Q=a(210),K=a(348),Y=a(354),X=a(358),$=a(359),ee=a(360),te=a(112),ae=a.n(te),ne=a(199),se=a.n(ne),ie=a(200),ce=a.n(ie),re=a(207),oe=H.a.TextArea,le=J.a.Link;ae.a.extend(se.a),ae.a.locale(ce.a);var de=function(e){Object(x.a)(a,e);var t=Object(k.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).handleLike=function(){n.state.isLiked||W({commentId:n.props.id}).then((function(e){e.data.success&&n.setState({isLiked:!0})})).catch((function(e){console.log(e)}))},n.state={isLiked:!1},n}return Object(O.a)(a,[{key:"submitLike",value:function(){var e=this;this.state.isLiked||W({commentId:this.props.id}).then((function(t){t.data.success&&e.setState({isLiked:!0})})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){return Object(n.jsxs)("div",{className:"vcomt-comt-wrapper",children:[Object(n.jsx)("div",{className:"vcomt-comt-avatar",children:Object(n.jsx)(Q.a,{icon:Object(n.jsx)(X.a,{})})}),Object(n.jsxs)("div",{className:"vcomt-comt-content",children:[Object(n.jsx)("div",{className:"vcomt-comt-content-uname",children:this.props.pname}),Object(n.jsx)("div",{className:"vcomt-comt-content-commt",children:this.props.content}),Object(n.jsxs)("div",{className:"vcomt-comt-content-action",children:[Object(n.jsx)("div",{className:"vcomt-comt-content-action-time",children:this.props.ptime}),Object(n.jsx)("div",{className:"vcomt-comt-content-action-reply",children:Object(n.jsx)(le,{children:"\u56de\u590d"})})]})]}),Object(n.jsxs)("div",{className:"vcomt-comt-like",onClick:this.handleLike,children:[Object(n.jsx)($.a,{className:this.state.isLiked?"liked":""}),Object(n.jsx)("div",{className:"vcomt-comt-like-num",children:this.state.isLiked?this.props.likeCount+1:this.props.likeCount})]})]})}}]),a}(i.a.Component),ue=function(e){Object(x.a)(a,e);var t=Object(k.a)(a);function a(){return Object(f.a)(this,a),t.apply(this,arguments)}return Object(O.a)(a,[{key:"render",value:function(){return Object(n.jsxs)("div",{className:"vcomt-action-appeal",children:[Object(n.jsx)("div",{className:"vcomt-action-appeal-text-area",children:"\u7559\u4e0b\u4f60\u7684\u7cbe\u5f69\u8bc4\u8bba\u5427"}),Object(n.jsx)("div",{className:"vcomt-action-appeal-micro-btn",children:Object(n.jsx)(ee.a,{})})]})}}]),a}(i.a.Component),me=function(e){Object(x.a)(a,e);var t=Object(k.a)(a);function a(){return Object(f.a)(this,a),t.apply(this,arguments)}return Object(O.a)(a,[{key:"render",value:function(){return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(K.a.Item,{children:Object(n.jsx)(oe,{rows:3,onChange:this.props.onChange,value:this.props.value})}),Object(n.jsxs)(K.a.Item,{children:[Object(n.jsx)(R.a,{htmlType:"submit",loading:this.props.submitting,onClick:this.props.onSubmit,type:"primary",children:"\u8bc4\u8bba\u4e00\u4e0b"}),Object(n.jsx)("div",{className:"vcomt-action-appeal-micro-btn",onClick:this.props.onOpenEmoji,children:Object(n.jsx)(ee.a,{})})]})]})}}]),a}(i.a.Component),he=function(e){Object(x.a)(a,e);var t=Object(k.a)(a);function a(e){var n;Object(f.a)(this,a),(n=t.call(this,e)).handleClose=function(){n.props.onCmtClose(!1)},n.handleSubmit=function(){var e;n.state.newComment&&(n.setState({isSubmitting:!0}),(e={comment:n.state.newComment,videoId:n.props.videoId},C.post("/comment",e)).then((function(e){var t=e.data;t.success&&setTimeout((function(){n.setState({isSubmitting:!1,newComment:"",comments:[].concat(Object(g.a)(n.state.comments),[{id:t.success,avatar:"",pname:"\u6211",ptime:ae()(new Date).fromNow(),like:!1,likeCount:0,content:n.state.newComment}])})}),500)})).catch((function(e){console.log(e)})))},n.handleChange=function(e){n.setState({newComment:e.target.value})},n.drawerChange=function(e){console.log(e)},n.addEmoji=function(e,t){n.setState({newComment:n.state.newComment+e.native,showEmojiModal:!1})},n.handleOpenEmojiModel=function(){n.setState({showEmojiModal:!n.state.showEmojiModal})};var s={id:"null",avatar:"string",pname:"string",ptime:"string",like:!0,likeCount:1,content:"string"};n.state={showEmojiModal:!1,vid:n.props.videoId,placement:"left",count:1,isTypeing:!1,isEmojing:!1,comments:[s,s,s],newComment:"",isSubmitting:!1};var i={videoId:n.props.videoId};return n.fetchComments(i),n}return Object(O.a)(a,[{key:"fetchComments",value:function(e){var t=this;z({videoId:e.videoId}).then((function(e){var a=e.data;a.success&&(a=a.data,console.log(a),a=a.map((function(e){var t;return{id:e._id,avatar:"null",pname:null===e||void 0===e||null===(t=e.userItem)||void 0===t?void 0:t.userName,ptime:ae()(e.createdAt).fromNow(),likeCount:e.liked,like:!1,content:e.comment}})),console.log(a),t.setState({comments:a}))})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this;return Object(n.jsx)(n.Fragment,{children:Object(n.jsx)(Y.a,{title:this.state.comments.length>=0?"".concat(this.state.comments.length," \u6761\u8bc4\u8bba"):"\u8bc4\u8bba\u533a",placement:"bottom",closable:!0,onClose:this.handleClose,visible:this.props.visible,afterVisibleChange:this.drawerChange,footer:Object(n.jsxs)("div",{children:[Object(n.jsx)(ue,{}),Object(n.jsx)("div",{className:"emoji-container",children:this.state.showEmojiModal&&Object(n.jsx)(re.a,{set:"apple",emoji:"",skin:1,showPreview:!1,style:{position:"absolute",bottom:"70px",left:"8px",zIndex:1},onClick:function(t,a){return e.addEmoji(t,a)}})}),Object(n.jsx)(me,{submitting:this.state.isSubmitting,value:this.state.newComment,onChange:this.handleChange,onSubmit:this.handleSubmit,onOpenEmoji:this.handleOpenEmojiModel})]}),height:500,bodyStyle:{paddingLeft:5,paddingRight:5},children:this.state.comments.map((function(e,t){return Object(s.createElement)(de,Object(S.a)(Object(S.a)({},e),{},{key:t}))}))},this.state.placement)})}}]),a}(i.a.Component),je=a(133),pe=a(211),be=a(124),ve=a.n(be);var ge=function(e){var t=Object(s.useState)(!1),a=Object(pe.a)(t,2),i=a[0],c=a[1];function r(){return(r=Object(v.a)(b.a.mark((function t(){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!i){t.next=2;break}return t.abrupt("return");case 2:return c(!0),e.onLiked(e.videoId),t.prev=4,t.next=7,N({videoId:e.videoId});case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(4),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[4,9]])})))).apply(this,arguments)}return Object(n.jsxs)("div",{className:ve.a.like,onClick:function(){return r.apply(this,arguments)},children:[Object(n.jsx)("div",{className:V()(ve.a["like-icon"],Object(je.a)({},ve.a.liked,i))}),Object(n.jsx)("div",{className:ve.a["like-number"],children:e.num})]})},fe=function(e){Object(x.a)(a,e);var t=Object(k.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).ChildPlayer=void 0,n.handleNewDmkChange=function(e){n.setState({newDmk:e.target.value})},n.handleSendDmk=function(e){var t;n.state.newDmk&&(n.setState({isSendingDmk:!0}),(t={vedioId:n.props.video._id,content:n.state.newDmk,size:20,start:n.state.timeStamp,color:"#001835"},C.post("/createDanmuku",t)).then((function(e){e.data.success&&(n.setState({newDmk:""}),n.ChildPlayer&&n.ChildPlayer.appendDmk(Object(S.a)(Object(S.a)({},e.data.data),{},{start:n.state.timeStamp+1500})))})).catch((function(e){return console.log(e)})).finally((function(){n.setState({isSendingDmk:!1})})))},n.handleTimeChange=function(e){n.setState({timeStamp:e})},n.handleDrawer=function(e){n.setState({showCmtDrawer:e})},n.handleOpenCmt=function(){console.log("open drawer"),n.setState({showCmtDrawer:!0})},n.handleLiked=function(){n.props.onLiked&&n.props.onLiked(n.props.video)},n.state={newDmk:"",timeStamp:0,isSendingDmk:!1,showCmtDrawer:!1},n}return Object(O.a)(a,[{key:"render",value:function(){var e=this,t=this.props.video,a=t._id,s=t.videoId,i=t.url,c=t.User,r=t.likeCounts,o=t.commentsCount,l=t.description,d=t.tags,u=this.props.active;return Object(n.jsxs)("div",{className:V()(_.a.video,{"video-avtice":u}),children:[Object(n.jsx)(F,{_id:a,id:s,url:i,type:"video",active:u,onTimeChange:this.handleTimeChange,onRef:function(t){e.ChildPlayer=t}}),Object(n.jsx)(he,{videoId:s,visible:this.state.showCmtDrawer,onCmtClose:this.handleDrawer}),Object(n.jsxs)("div",{className:_.a.info,children:[Object(n.jsx)("div",{className:_.a.liveComents,children:Object(n.jsx)(G,{type:"video",id:s})}),Object(n.jsxs)("div",{className:_.a.author,children:["@",c[0].userName]}),Object(n.jsx)("div",{className:_.a.description,children:l}),Object(n.jsx)("div",{className:_.a.tags,children:d&&d.map((function(e){return Object(n.jsxs)("span",{className:_.a.tag,children:["#",e]},e)}))}),Object(n.jsxs)("div",{className:_.a.danmu,children:[Object(n.jsx)("input",{value:this.state.newDmk,onChange:this.handleNewDmkChange,placeholder:"\u53d1\u4e2a\u53cb\u5584\u7684\u5f39\u5e55\u89c1\u8bc1\u5f53\u4e0b"}),Object(n.jsx)(R.a,{type:"primary",shape:"circle",icon:Object(n.jsx)(M.a,{}),size:"middle",onClick:this.handleSendDmk,loading:this.state.isSendingDmk})]})]}),Object(n.jsxs)("div",{className:_.a.action,children:[Object(n.jsx)(ge,{videoId:s,num:r,onLiked:this.handleLiked}),Object(n.jsxs)("div",{className:_.a.comment,onClick:this.handleOpenCmt,children:[Object(n.jsx)("div",{className:_.a["comment-icon"]}),Object(n.jsx)("div",{className:_.a["comment-number"],children:o})]})]})]})}}]),a}(i.a.Component),Oe=a(73),xe=a.n(Oe),ke=function(e){Object(x.a)(a,e);var t=Object(k.a)(a);function a(){return Object(f.a)(this,a),t.apply(this,arguments)}return Object(O.a)(a,[{key:"render",value:function(){return Object(n.jsxs)("div",{className:xe.a.top,children:[Object(n.jsx)("div",{className:xe.a.left,children:Object(n.jsx)(o.b,{to:"/live",children:Object(n.jsx)("div",{style:{color:"#ffffff"},children:"\u76f4\u64ad"})})}),Object(n.jsx)("div",{className:xe.a.middle,children:Object(n.jsxs)("div",{className:xe.a.navbar,children:[Object(n.jsx)(o.b,{to:"/mypage",children:Object(n.jsx)("div",{className:xe.a["navbar-item"],style:{color:"#ffffff"},children:"\u6211"})}),Object(n.jsx)("div",{className:xe.a["navbar-item"],children:"\u5173\u6ce8"}),Object(n.jsx)("div",{className:"".concat(xe.a["navbar-item"]," ").concat(xe.a["navbar-item-active"]),children:"\u63a8\u8350"})]})}),Object(n.jsx)("div",{className:xe.a.right,children:Object(n.jsx)("div",{className:xe.a["search-btn"]})})]})}}]),a}(i.a.Component),ye=(a(333),a(345)),we=a(343),Ce=(a(196),function(e){Object(x.a)(a,e);var t=Object(k.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).handleSwiperChange=function(e){console.log(e);var t=n.state,a=t.videoList,s=t.inPageVideoList,i=e.activeIndex;i===s.length-1&&i<a.length-1&&(console.log("added"),n.setState({inPageVideoList:[].concat(Object(g.a)(s),[a[i+1]])}),e.update()),console.log("Active swiper:",i),n.setState({activeIndex:i})},n.handleLiked=function(e){var t=n.state.videoList.find((function(t){return t===e}));t&&t.likeCounts++},n.state={videoList:[],inPageVideoList:[],activeIndex:0},n}return Object(O.a)(a,[{key:"componentDidMount",value:function(){var e=Object(v.a)(b.a.mark((function e(){var t,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.post("/searchVideo");case 3:t=e.sent,a=t.data.success.list,this.setState({videoList:a}),this.setState({inPageVideoList:a.slice(0,2)}),console.log(this.state),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,a=t.inPageVideoList,s=t.activeIndex;return Object(n.jsxs)("div",{className:"home",children:[Object(n.jsx)(ke,{}),a&&a.length&&Object(n.jsx)(ye.a,{spaceBetween:0,slidesPerView:1,direction:"vertical",onSlideChange:function(t){return e.handleSwiperChange(t)},height:window.innerHeight,autoHeight:!0,children:a.map((function(t,a){return Object(n.jsx)(we.a,{children:Object(n.jsx)(fe,{video:t,active:s===a,onLiked:e.handleLiked})},t._id)}))})]})}}]),a}(i.a.Component)),Ne=a(114),Se=a.n(Ne),Ie=function(e){Object(x.a)(a,e);var t=Object(k.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).liveComment=void 0,n.handleNewComment=function(e){n.setState({comment:e.target.value})},n.handleSendComment=Object(v.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isSendingComment:!0}),e.prev=1,e.next=4,a={comment:n.state.comment},C.post("/commentLive",a);case 4:n.setState({comment:""}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0);case 10:n.setState({isSendingComment:!1}),null===(t=n.liveComment.current)||void 0===t||t.fetchCommentsLive({videoId:n.props.video.videoId});case 12:case"end":return e.stop()}var a}),e,null,[[1,7]])}))),n.state={comment:"",isSendingComment:!1},n.liveComment=i.a.createRef(),n}return Object(O.a)(a,[{key:"render",value:function(){var e=this.props.video,t=e._id,a=e.videoId,s=e.url,i=this.props.active;return Object(n.jsxs)("div",{className:Se.a.live,children:[Object(n.jsx)(F,{_id:t,id:a,url:s,type:"live",active:i}),Object(n.jsx)("div",{className:Se.a.info,children:Object(n.jsxs)("div",{className:Se.a.liveComents,children:[Object(n.jsx)(G,{ref:this.liveComment,type:"live",id:a}),Object(n.jsxs)("div",{className:Se.a.input,children:[Object(n.jsx)("input",{className:Se.a.input,value:this.state.comment,onChange:this.handleNewComment,placeholder:"\u8bf4\u70b9\u4ec0\u4e48..."}),Object(n.jsx)(R.a,{type:"primary",size:"small",shape:"round",onClick:this.handleSendComment,loading:this.state.isSendingComment,disabled:""===this.state.comment,children:"\u53d1\u9001"})]})]})})]})}}]),a}(i.a.Component),_e=a(115),Le=a.n(_e),Pe=function(e){Object(x.a)(a,e);var t=Object(k.a)(a);function a(){return Object(f.a)(this,a),t.apply(this,arguments)}return Object(O.a)(a,[{key:"render",value:function(){return Object(n.jsxs)("div",{className:Le.a.top,children:[Object(n.jsx)("div",{className:Le.a.left}),Object(n.jsx)("div",{className:Le.a.middle}),Object(n.jsx)("div",{className:Le.a.right,children:Object(n.jsx)(o.b,{to:"/",children:Object(n.jsx)("div",{className:Le.a["close-btn"]})})})]})}}]),a}(i.a.Component),Te=function(e){Object(x.a)(a,e);var t=Object(k.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).handleSwiperChange=function(e){console.log(e);var t=n.state,a=t.liveList,s=t.inPageLiveList,i=e.activeIndex;i===s.length-1&&i<a.length-1&&(console.log("added"),n.setState({inPageLiveList:[].concat(Object(g.a)(s),[a[i+1]])}),e.update()),console.log("Active swiper:",i),n.setState({activeIndex:i})},n.state={liveList:[],inPageLiveList:[],activeIndex:0},n}return Object(O.a)(a,[{key:"componentDidMount",value:function(){var e=Object(v.a)(b.a.mark((function e(){var t,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.post("/searchLive");case 3:t=e.sent,a=t.data.success.list,this.setState({liveList:a}),this.setState({inPageLiveList:a.slice(0,2)}),console.log(this.state),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,a=t.inPageLiveList,s=t.activeIndex;return Object(n.jsxs)("div",{className:"live",children:[Object(n.jsx)(Pe,{}),a&&a.length&&Object(n.jsx)(ye.a,{spaceBetween:0,slidesPerView:1,direction:"vertical",onSlideChange:function(t){return e.handleSwiperChange(t)},height:window.innerHeight,autoHeight:!0,children:a.map((function(e,t){return Object(n.jsx)(we.a,{children:Object(n.jsx)(Ie,{video:e,active:s===t})},e._id)}))})]})}}]),a}(i.a.Component),Ue=a(353),De=a(214),Be=a(213),Ve=a(55),Fe=a(344),Re=a(347),Me=a(346),Ee=a(356),qe=a(357),ze=a(362),We=a(363),Ae=a(364),Ze=a(365),Ge=a(63),He=a(217),Je=a(110),Qe=a(366),Ke=a(367),Ye=a(216),Xe=a(172),$e=(a(338),Ue.a.Option),et=function(e){Object(x.a)(a,e);var t=Object(k.a)(a);function a(){return Object(f.a)(this,a),t.apply(this,arguments)}return Object(O.a)(a,[{key:"handleTriggerQR",value:function(){console.log("QRCode is unavaliable now")}},{key:"render",value:function(){return Object(n.jsxs)("div",{className:"usercenter-card -front ".concat("login"===this.props.mode?"show":"hide"," "),children:[Object(n.jsx)("div",{className:"usercenter-card-focus"}),Object(n.jsx)("div",{className:"usercenter-card-background",children:Object(n.jsx)("img",{src:this.props.bg,className:"usercenter-card__bg"})}),Object(n.jsxs)("div",{className:"usercenter-card-wrapper",children:[Object(n.jsxs)("div",{className:"usercenter-card-login-header",children:[Object(n.jsx)("div",{className:"usercenter-card-login-header_qrbtn",onClick:this.handleTriggerQR,children:Object(n.jsx)(ze.a,{})}),Object(n.jsx)("img",{className:"usercenter-card-login-header_logo",src:"//sf3-ttcdn-tos.pstatp.com/obj/ttfe/passport/sso/douyin/douyin-logo_1576745941218.png",alt:"logo"})]}),Object(n.jsxs)("div",{className:"usercenter-card-login-content",children:[Object(n.jsx)(Q.a,{size:{xs:70,sm:70,md:70,lg:80,xl:80,xxl:80},src:this.props.avatar,icon:Object(n.jsx)(We.a,{})}),Object(n.jsx)("div",{className:"usercenter-card-login-content_user",children:this.props.uname})]})]})]})}}]),a}(i.a.Component),tt=function(e){Object(x.a)(a,e);var t=Object(k.a)(a);function a(){return Object(f.a)(this,a),t.apply(this,arguments)}return Object(O.a)(a,[{key:"render",value:function(){return Object(n.jsxs)("div",{className:"usercenter-card -back ".concat("loginSucs"===this.props.mode||"regiSucs"===this.props.mode?"show":"hide"),children:[Object(n.jsx)("div",{className:"usercenter-card-focus"}),Object(n.jsx)("div",{className:"usercenter-card-background",children:Object(n.jsx)("img",{src:this.props.bg,className:"usercenter-card__bg"})}),Object(n.jsxs)("div",{className:"usercenter-card-wrapper",children:[Object(n.jsxs)("div",{className:"usercenter-card-login-header",children:[Object(n.jsx)("div",{className:"usercenter-card-login-header_info"}),Object(n.jsx)("img",{className:"usercenter-card-login-header_logo",src:"//sf3-ttcdn-tos.pstatp.com/obj/ttfe/passport/sso/douyin/douyin-logo_1576745941218.png",alt:"logo"})]}),Object(n.jsxs)("div",{className:"usercenter-card-login-content",children:[Object(n.jsx)(Q.a,{size:{xs:70,sm:40,md:40,lg:64,xl:80,xxl:100},src:this.props.avatar,icon:Object(n.jsx)(We.a,{})}),Object(n.jsx)("div",{className:"usercenter-card-login-content_user",children:this.props.uname}),Object(n.jsx)("div",{className:"usercenter-card-login-content_info",children:"\u6b22\u8fce\u56de\u6765\uff0c\u6b63\u5728\u8df3\u8f6c..."})]})]})]})}}]),a}(i.a.Component),at=function(e){Object(x.a)(a,e);var t=Object(k.a)(a);function a(){return Object(f.a)(this,a),t.apply(this,arguments)}return Object(O.a)(a,[{key:"hadleTriggerQR",value:function(){console.log("QRCode is unavaliable now")}},{key:"render",value:function(){return Object(n.jsxs)("div",{className:V()("usercenter-card","-register","-front",{hide:"regi"!==this.props.mode}),children:[Object(n.jsx)("div",{className:"usercenter-card-background",children:Object(n.jsx)("img",{src:this.props.bg,className:"usercenter-card__bg"})}),Object(n.jsxs)("div",{className:"usercenter-card-wrapper",children:[Object(n.jsxs)("div",{className:"usercenter-card-regi-header",children:[Object(n.jsxs)("div",{className:"usercenter-card-regi-header-info",onClick:this.handleTriggerQR,children:[Object(n.jsxs)("div",{className:"item",children:[Object(n.jsx)(Ae.a,{}),this.props.ages]}),Object(n.jsxs)("div",{className:"item",children:[Object(n.jsx)(Ze.a,{}),this.props.regin]})]}),Object(n.jsx)("img",{className:"usercenter-card-login-header_logo",src:"//sf3-ttcdn-tos.pstatp.com/obj/ttfe/passport/sso/douyin/douyin-logo_1576745941218.png",alt:"logo"})]}),Object(n.jsxs)("div",{className:"usercenter-card-login-content",children:[Object(n.jsx)(Q.a,{size:{xs:70,sm:40,md:40,lg:64,xl:80,xxl:100},src:this.props.avatar,icon:Object(n.jsx)(We.a,{})}),Object(n.jsx)("div",{className:"usercenter-card-login-content_user",children:this.props.uname})]})]})]})}}]),a}(i.a.Component),nt=function(e){Object(x.a)(a,e);var t=Object(k.a)(a);function a(e){var s;return Object(f.a)(this,a),(s=t.call(this,e)).regiFormRef=i.a.createRef(),s.notiNetworkErr=function(){De.a.error({message:"\u6ce8\u518c\u63d0\u4ea4\u5931\u8d25",description:"\u63d0\u4ea4\u6ce8\u518c\u4fe1\u606f\u7684\u65f6\u5019\u548c\u661f\u7403\u5931\u53bb\u8fde\u63a5\u5566\uff0c\u518d\u5c1d\u8bd5\u4e00\u4e0b\u5427"})},s.handleOnRegiSubmit=function(e){console.log("Received values of form: ",e),delete e.agreement,s.setState({formSubmiting:!0}),w.a.post("https://qcmt57.fn.thelarkcloud.com/register",e).then((function(e){if(console.log(e),e.data.success)console.log("Registered!!"),h(e.data.userId),u(e.data.token),s.props.onModechange("regiSucs"),s.props.onRegisterSuccess();else{var t={emailUnvali:e.data.isEmailExist,unameUnvali:e.data.isUnameExist};s.setState(t)}})).catch((function(e){console.log(e),s.notiNetworkErr()}))},s.tailFormItemLayout={wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:8}}},s.handleAvatarChange=function(e){console.log(e),"uploading"!==e.file.status?"done"===e.file.status&&e.file.response.success&&(s.setState({avatarUrl:e.file.response.url}),s.regiFormRef.current.setFieldsValue({avatar:e.file.response.url}),s.props.onCardUpdate({avatar:e.file.response.url})):s.setState({avatarLoading:!0})},s.handleBgImgChange=function(e){"uploading"!==e.file.status?"done"===e.file.status&&e.file.response.success&&(s.setState({bgImgUrl:e.file.response.url,bgImgLoading:!1}),s.regiFormRef.current.setFieldsValue({bgImg:e.file.response.url}),s.props.onCardUpdate({cardBg:e.file.response.url})):s.setState({bgImgLoading:!0})},s.handleUnameChange=function(e){s.props.onCardUpdate({uname:e.target.value||"\u6296\u97f3"})},s.handleReginChange=function(e){s.props.onCardUpdate({regin:e.target.value||"\u5730\u7403\u6751"})},s.uploadButtonAvatar=function(){return Object(n.jsxs)("div",{children:[s.state.avatarLoading?Object(n.jsx)(Ge.a,{}):Object(n.jsx)(He.a,{}),Object(n.jsx)("div",{style:{marginTop:8},children:"\u4e0a\u4f20\u5934\u50cf"})]})},s.uploadButtonBgImg=function(){return Object(n.jsxs)("div",{children:[s.state.bgImgLoading?Object(n.jsx)(Ge.a,{}):Object(n.jsx)(He.a,{}),Object(n.jsx)("div",{style:{marginTop:8},children:"\u4e0a\u4f20\u80cc\u666f\u56fe"})]})},s.handleChange=function(){(s.state.unameUnvali||s.state.emailUnvali)&&s.setState({emailUnvali:!1,unameUnvali:!1})},s.state={loaingAvatar:!1,avatarUrl:"",avatarLoading:!1,bgImgUrl:"",bgImgLoading:!1,emailUnvali:!1,unameUnvali:!1,formSubmiting:!1},s}return Object(O.a)(a,[{key:"beforeUpload",value:function(e){var t="image/jpeg"===e.type||"image/png"===e.type;t||Be.b.error("You can only upload JPG/PNG file!");var a=e.size/1024/1024<2;return a||Be.b.error("Image must smaller than 2MB!"),t&&a}},{key:"render",value:function(){var e=this;return Object(n.jsx)("div",{className:"usercenter-form-card",children:Object(n.jsxs)(K.a,{ref:this.regiFormRef,name:"control-ref",onFinish:this.handleOnRegiSubmit,scrollToFirstError:!0,children:[Object(n.jsx)(K.a.Item,Object(S.a)(Object(S.a)({name:"email",label:"\u90ae\u7bb1",hasFeedback:!0},this.state.emailUnvali?{validateStatus:"error",help:"\u8fd9\u4e2a\u90ae\u7bb1\u5df2\u7ecf\u88ab\u4f7f\u7528\u8fc7\u4e86"}:{}),{},{rules:[{required:!0,type:"email",message:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u7bb1\u5730\u5740"}],children:Object(n.jsx)(H.a,{style:{width:"100%"}})})),Object(n.jsx)(K.a.Item,{name:"password",label:"\u5bc6\u7801",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801"}],hasFeedback:!0,children:Object(n.jsx)(H.a.Password,{})}),Object(n.jsx)(K.a.Item,{name:"confirm",label:"\u786e\u8ba4\u5bc6\u7801",dependencies:["password"],hasFeedback:!0,rules:[{required:!0,message:"\u8bf7\u786e\u8ba4\u60a8\u7684\u5bc6\u7801"},function(e){var t=e.getFieldValue;return{validator:function(e,a){return a&&t("password")!==a?Promise.reject(new Error("\u4e24\u4e2a\u5bc6\u7801\u4e0d\u5339\u914d")):Promise.resolve()}}}],children:Object(n.jsx)(H.a.Password,{})}),Object(n.jsx)(K.a.Item,Object(S.a)(Object(S.a)({name:"userName",label:Object(n.jsxs)("span",{children:["\u6635\u79f0\xa0",Object(n.jsx)(Ve.a,{title:"\u6ce8\u518c\u4e4b\u540e\u53ef\u4ee5\u968f\u65f6\u5728\u4e2a\u4eba\u4e2d\u5fc3\u4fee\u6539",children:Object(n.jsx)(Je.a,{})})]}),hasFeedback:!0},this.state.unameUnvali?{validateStatus:"error",help:"\u4f60\u5f88\u6709\u773c\u5149\uff0c\u4f46\u662f\u5df2\u7ecf\u88ab\u4eba\u770b\u4e2d\u5566"}:{}),{},{rules:[{required:!0,message:"\u4e00\u4e2a\u6635\u79f0\u53ef\u4ee5\u66f4\u597d\u7684\u8ba9\u522b\u4eba\u8bb0\u4f4f\u4f60\u54e6",whitespace:!0}],children:Object(n.jsx)(H.a,{onChange:this.handleUnameChange})})),Object(n.jsx)(Fe.a,{orientation:"left",children:"\u4e2a\u6027\u4fe1\u606f"}),Object(n.jsx)(K.a.Item,{label:"\u5934\u50cf",children:Object(n.jsx)(Xe.a,{rotate:!0,shape:"round",modalTitle:"\u88c1\u526a\u5934\u50cf",children:Object(n.jsx)(Re.a,{name:"file",listType:"picture-card",className:"avatar-uploader",showUploadList:!1,action:"https://qcmt57.fn.thelarkcloud.com/fileUpload",beforeUpload:this.beforeUpload,onChange:this.handleAvatarChange,children:this.state.avatarUrl?Object(n.jsx)("img",{src:this.state.avatarUrl,alt:"avatar",style:{width:"100%"}}):this.uploadButtonAvatar()})})}),Object(n.jsx)(K.a.Item,{name:"avatar",style:{display:"none"},children:Object(n.jsx)(H.a,{})}),Object(n.jsx)(K.a.Item,{label:"\u80cc\u666f\u56fe",children:Object(n.jsx)(Xe.a,{rotate:!0,modalTitle:"\u88c1\u526a\u5361\u7247\u80cc\u666f",aspect:16/9,children:Object(n.jsx)(Re.a,{name:"file",listType:"picture-card",showUploadList:!1,action:"https://qcmt57.fn.thelarkcloud.com/fileUpload",beforeUpload:this.beforeUpload,onChange:this.handleBgImgChange,style:{width:"50px",height:"28px"},children:this.state.bgImgUrl?Object(n.jsx)("img",{src:this.state.bgImgUrl,alt:"avatar",style:{width:"100%"}}):this.uploadButtonBgImg()})})}),Object(n.jsx)(K.a.Item,{name:"bgImg",style:{display:"none"},children:Object(n.jsx)(H.a,{})}),Object(n.jsx)(K.a.Item,{name:"birthDay",label:"\u751f\u65e5",children:Object(n.jsx)(Me.a,{})}),Object(n.jsx)(K.a.Item,{name:"regin",label:"\u6240\u5728\u5730",children:Object(n.jsx)(H.a,{style:{width:"100%"},onChange:this.handleReginChange})}),Object(n.jsx)(K.a.Item,{name:"bio",label:"\u4e2a\u6027\u7b7e\u540d",children:Object(n.jsx)(H.a,{style:{width:"100%"}})}),Object(n.jsx)(K.a.Item,{name:"gender",label:"\u6027\u522b",rules:[{required:!0}],children:Object(n.jsxs)(Ue.a,{placeholder:"\u8bf7\u9009\u62e9\u6027\u522b",allowClear:!0,style:{width:"50%"},children:[Object(n.jsx)($e,{value:"male",children:"\u7537"}),Object(n.jsx)($e,{value:"female",children:"\u5973"}),Object(n.jsx)($e,{value:"other",children:"\u4fdd\u5bc6"})]})}),Object(n.jsx)(K.a.Item,Object(S.a)(Object(S.a)({name:"agreement",valuePropName:"checked",rules:[{validator:function(e,t){return t?Promise.resolve():Promise.reject(new Error("\u6ce8\u518c\u7528\u6237\u9700\u8981\u5148\u540c\u610f\u7528\u6237\u534f\u8bae"))}}]},this.tailFormItemLayout),{},{children:Object(n.jsxs)(Ee.a,{children:["\u6211\u5df2\u9605\u8bfb\u5e76\u540c\u610f ",Object(n.jsx)("a",{href:"#",children:"\u7528\u6237\u534f\u8bae"})]})})),Object(n.jsx)(K.a.Item,Object(S.a)(Object(S.a)({},this.tailFormItemLayout),{},{children:Object(n.jsx)(R.a,{type:"primary",htmlType:"submit",loading:this.state.formSubmiting,children:"\u52a0\u5165\u6296\u97f3"})})),Object(n.jsxs)("span",{children:["\u5df2\u6709\u5e10\u53f7\u8bf7 ",Object(n.jsx)("a",{href:"#",onClick:function(){return e.props.onModechange("login")},children:"\u767b\u5f55"})]})]})})}}]),a}(i.a.Component),st=function(e){Object(x.a)(a,e);var t=Object(k.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).previewGet=function(e){w.a.post("https://qcmt57.fn.thelarkcloud.com/userIconPreview",{user:e}).then(function(e){if(!e.data.success)throw new Error;this.props.onCardUpdate(e.data)}.bind(Object(L.a)(n))).catch(function(e){console.log(e),this.props.onCardReset()}.bind(Object(L.a)(n)))},n.handlePreview=function(e){n.state.previewTimer&&clearTimeout(n.state.previewTimer);var t=setTimeout(function(){this.previewGet(e.target.value)}.bind(Object(L.a)(n)),400);n.setState({previewTimer:t})},n.handleLogin=function(e){console.log(e),n.setState({loading:!0,showMsg:!1}),w.a.post("https://qcmt57.fn.thelarkcloud.com/login",{userName:e.username,password:e.password}).then(function(e){if(console.log(e),this.setState({loading:!1,disabled:!0}),!e.data.success)throw new Error("login failed");u(e.data.token),h(e.data.userId),this.props.onModechange("loginSucs"),console.log(this.props),this.props.onLoginSuccess()}.bind(Object(L.a)(n))).catch(function(e){this.setState({loading:!1,showMsg:!0}),console.log(e)}.bind(Object(L.a)(n)))},n.state={loading:!1,disabled:!1,showMsg:!1,previewTimer:null},n}return Object(O.a)(a,[{key:"render",value:function(){var e=this;return Object(n.jsxs)("div",{className:"usercenter-form-card usercenter-form-login",children:[this.state.showMsg?Object(n.jsx)(qe.a,{message:"\u5e10\u53f7/\u5bc6\u7801\u9519\u8bef\uff0c\u8bf7\u786e\u8ba4\u540e\u91cd\u8bd5",type:"error",showIcon:!0}):"",Object(n.jsxs)(K.a,{name:"normal_login",id:"usercenter-form-card-content",layout:"vertical",initialValues:{remember:!0},onFinish:this.handleLogin,requiredMark:!1,children:[Object(n.jsx)(K.a.Item,{name:"username",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"}],children:Object(n.jsx)(H.a,{prefix:Object(n.jsx)(X.a,{className:"site-form-item-icon"}),placeholder:"\u90ae\u7bb1/\u7528\u6237\u540d",onChange:this.handlePreview})}),Object(n.jsx)(K.a.Item,{name:"password",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801"}],children:Object(n.jsx)(H.a.Password,{className:"input",prefix:Object(n.jsx)(Qe.a,{className:"site-form-item-icon"}),placeholder:"\u8d26\u53f7\u5bc6\u7801",iconRender:function(e){return e?Object(n.jsx)(Ke.a,{}):Object(n.jsx)(Ye.a,{})}})}),Object(n.jsxs)(K.a.Item,{style:"",children:[Object(n.jsx)(K.a.Item,{name:"remember",valuePropName:"checked",noStyle:!0,children:Object(n.jsx)(Ee.a,{children:"\u8bb0\u4f4f\u5bc6\u7801"})}),Object(n.jsx)("a",{className:"login-form-forgot",href:"#",children:"\u5fd8\u8bb0\u5bc6\u7801?"})]}),Object(n.jsx)("div",{className:"login-form-btn",children:Object(n.jsx)(K.a.Item,{className:"login-btn",noStyle:!0,children:Object(n.jsx)(R.a,{type:"primary",htmlType:"submit",loading:this.state.loading,disabled:"login"!==this.props.mode,children:"\u767b\u5f55"})})}),Object(n.jsx)("div",{className:"login-form-footer",children:Object(n.jsxs)(K.a.Item,{children:["\u6216 ",Object(n.jsx)("a",{href:"#",onClick:function(){return e.props.onModechange("regi")},children:"\u73b0\u5728\u6ce8\u518c"})]})})]})]})}}]),a}(i.a.Component),it=function(e){Object(x.a)(a,e);var t=Object(k.a)(a);function a(e){var n;Object(f.a)(this,a),(n=t.call(this,e)).handleChangeMode=function(e){n.setState({mode:e})},n.onFinish=function(e){console.log("Received values of form: ",e)},n.handleResetLoginCard=function(){n.setState({cardBg:"https://sf1-ttcdn-tos.pstatp.com/obj/larkcloud-file-storage/baas/qcmt57/34d55516367c98c2_1612876325199.png",avatar:"https://sf1-ttcdn-tos.pstatp.com/obj/larkcloud-file-storage/baas/qcmt57/0bb96d4c05cc0a53_1612876378525.jpeg"})},n.handleSetLoginCard=function(e){n.setState({cardBg:e.data.bgImg,uname:e.data.uname,avatar:e.data.avatar})},n.handleSetRegiCard=function(e){n.setState(Object(S.a)(Object(S.a)({},n.state),e))},n.handleLoginSuccess=function(){setTimeout((function(){n.props.history.push("/")}),1e3)};return n.state={mode:"login",cardBg:"https://sf1-ttcdn-tos.pstatp.com/obj/larkcloud-file-storage/baas/qcmt57/34d55516367c98c2_1612876325199.png",avatar:"https://sf1-ttcdn-tos.pstatp.com/obj/larkcloud-file-storage/baas/qcmt57/0bb96d4c05cc0a53_1612876378525.jpeg",uname:"\u6296\u97f3",ages:"\u5c0f\u9c9c\u8089",regin:"\u5730\u7403\u6751"},n}return Object(O.a)(a,[{key:"render",value:function(){var e={};switch(this.state.mode){case"login":case"loginSucs":e=Object(n.jsx)(st,{onLoginSuccess:this.handleLoginSuccess,mode:this.state.mode,onCardUpdate:this.handleSetLoginCard,onCardReset:this.handleResetLoginCard,onModechange:this.handleChangeMode});break;case"regi":case"regiSucs":e=Object(n.jsx)(nt,{onRegisterSuccess:this.handleLoginSuccess,mode:this.state.mode,onCardUpdate:this.handleSetRegiCard,onModechange:this.handleChangeMode})}return Object(n.jsxs)("div",{className:"usercenter-wrapper",children:[Object(n.jsxs)("div",{className:"card-item",children:[Object(n.jsx)(et,{mode:this.state.mode,avatar:this.state.avatar,uname:this.state.uname,bg:this.state.cardBg}),Object(n.jsx)(tt,{mode:this.state.mode,bg:this.state.cardBg,avatar:this.state.avatar,uname:this.state.uname}),Object(n.jsx)(at,{mode:this.state.mode,bg:this.state.cardBg,avatar:this.state.avatar,uname:this.state.uname,ages:this.state.ages,regin:this.state.regin})]}),e]})}}]),a}(i.a.Component),ct=function(e){Object(x.a)(a,e);var t=Object(k.a)(a);function a(){return Object(f.a)(this,a),t.apply(this,arguments)}return Object(O.a)(a,[{key:"render",value:function(){return Object(n.jsx)(n.Fragment,{children:Object(n.jsx)(it,{history:this.props.history})})}}]),a}(i.a.Component),rt=function(){var e=Object(l.g)();return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("video",{id:"ucenterBgVedio",playsInline:!0,autoPlay:!0,muted:!0,loop:!0,"x5-video-player-type":"h5",src:"https://sf1-ttcdn-tos.pstatp.com/obj/larkcloud-file-storage/baas/qcmt57/cbbf7b1a02c400d6_1612887218358.mp4","data-object-fit":"true",type:"video/mp4",poster:"https://sf1-scmcdn-tos.pstatp.com/goofy/ies/douyin_home_web/imgs/1.9e1ce889.jpg",children:"\u62b1\u6b49\uff0c\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u5185\u5d4c\u89c6\u9891"}),Object(n.jsx)("div",{className:"wrapper",children:Object(n.jsx)(ct,{history:e})})]})},ot=a(351),lt=a(350),dt=a(215),ut=a(368),mt=a(369),ht=(a(339),function(e){return C.post("/getUserInfo",e)}),jt=J.a.Text,pt=ot.a.TabPane,bt=function(e){Object(x.a)(a,e);var t=Object(k.a)(a);function a(){return Object(f.a)(this,a),t.apply(this,arguments)}return Object(O.a)(a,[{key:"render",value:function(){return Object(n.jsx)("div",{className:"mypage-header-cover",children:Object(n.jsx)("img",{src:this.props.bgImg})})}}]),a}(i.a.Component),vt=function(e){var t=e.num,a=e.discribe;return Object(n.jsxs)(jt,{lcass:"number-info",children:[Object(n.jsx)("span",{className:"number-info-num",children:t}),a]})},gt=function(e){Object(x.a)(a,e);var t=Object(k.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).state={userInfo:{},works:[{id:1,src:"https://lh3.google.com/pw/ACtC-3fmxFDDRSNKZqDDfvml85Vz7BjfkZOeTN2ePOw_JhdFe1ezWToyZ5OTvlkHgkgUxBfGyKpgWZcsOV50fYl_bDp99Y1V0UE=w749-h799-no?authuser=0",Date:"Mon Feb 08 2021 23:25:04 GMT+0800 (\u4e2d\u56fd\u6807\u51c6\u65f6\u95f4)"},{id:3,src:"https://lh3.google.com/pw/ACtC-3fmxFDDRSNKZqDDfvml85Vz7BjfkZOeTN2ePOw_JhdFe1ezWToyZ5OTvlkHgkgUxBfGyKpgWZcsOV50fYl_bDp99Y1V0UE=w749-h799-no?authuser=0",Date:"Mon Feb 08 2021 23:25:04 GMT+0800 (\u4e2d\u56fd\u6807\u51c6\u65f6\u95f4)"},{id:4,src:"https://lh3.google.com/pw/ACtC-3fmxFDDRSNKZqDDfvml85Vz7BjfkZOeTN2ePOw_JhdFe1ezWToyZ5OTvlkHgkgUxBfGyKpgWZcsOV50fYl_bDp99Y1V0UE=w749-h799-no?authuser=0",Date:"Mon Feb 08 2021 23:25:04 GMT+0800 (\u4e2d\u56fd\u6807\u51c6\u65f6\u95f4)"},{id:2,src:"https://lh3.google.com/pw/ACtC-3fmxFDDRSNKZqDDfvml85Vz7BjfkZOeTN2ePOw_JhdFe1ezWToyZ5OTvlkHgkgUxBfGyKpgWZcsOV50fYl_bDp99Y1V0UE=w749-h799-no?authuser=0",Date:"Mon Feb 08 2021 23:25:04 GMT+0800 (\u4e2d\u56fd\u6807\u51c6\u65f6\u95f4)"}]},n}return Object(O.a)(a,[{key:"render",value:function(){return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("div",{className:"mypage-main-works",children:this.state.works.map((function(e,t){return Object(n.jsxs)("div",{className:"mypage-main-work-wrap",children:[Object(n.jsx)(lt.a,{src:"https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png",preview:!1,placeholder:Object(n.jsx)(lt.a,{preview:!1,src:"https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png?x-oss-process=image/blur,r_50,s_50/quality,q_1/resize,m_mfit,h_200,w_200"})}),Object(n.jsxs)("div",{className:"label",children:[Object(n.jsx)(ut.a,{})," 15"]})]},t)}))}),Object(n.jsx)(jt,{className:"mypage-main-footer",children:"\u6682\u65f6\u6ca1\u6709\u66f4\u591a\u4e86"})]})}}]),a}(i.a.Component),ft=function(e){Object(x.a)(a,e);var t=Object(k.a)(a);function a(){return Object(f.a)(this,a),t.apply(this,arguments)}return Object(O.a)(a,[{key:"render",value:function(){return Object(n.jsxs)(ot.a,{defaultActiveKey:"work",centered:!0,animated:{inkBar:!0,tabPane:!0},children:[Object(n.jsx)(pt,{tab:"\u4f5c\u54c1",children:Object(n.jsx)(gt,{})},"work"),Object(n.jsx)(pt,{tab:"\u79c1\u5bc6",children:Object(n.jsx)(gt,{})},"priv"),Object(n.jsx)(pt,{tab:"\u559c\u6b22",children:Object(n.jsx)(gt,{})},"like")]})}}]),a}(i.a.Component),Ot=function(e){Object(x.a)(a,e);var t=Object(k.a)(a);function a(){return Object(f.a)(this,a),t.apply(this,arguments)}return Object(O.a)(a,[{key:"handleShowQR",value:function(){console.log("showQr")}},{key:"render",value:function(){var e,t;return console.log(null===(e=this.props)||void 0===e?void 0:e.badgeItem),Object(n.jsxs)("div",{className:"mypage-info",children:[Object(n.jsxs)("div",{className:"mypage-info-header",children:[Object(n.jsxs)("div",{className:"mypage-info-header-avatar",children:[Object(n.jsx)("img",{className:"mypage-info-header-avatar-img",src:this.props.avatar}),Object(n.jsx)("img",{className:"mypage-info-header-avatar-ripon",src:null===(t=this.props)||void 0===t?void 0:t.badgeurl})]}),Object(n.jsxs)(o.b,{to:"/myBadge",children:[" ",Object(n.jsxs)(R.a,{style:{maxWidth:"130px",marginRight:"45px",marginLeft:"auto"},block:!0,children:["\u7f16\u8f91\u8d44\u6599",Object(n.jsx)("span",{style:{color:"grey"},children:"25%"})]})]}),Object(n.jsx)(R.a,{style:{maxWidth:"80px"},type:"primary",block:!0,children:"\u627e\u670b\u53cb"})]}),Object(n.jsx)("div",{className:"mypage-info-nickname",children:this.props.userName}),Object(n.jsxs)("div",{className:"mypage-info-tikid",children:["\u6296\u97f3\u53f7:jhonlee",Object(n.jsx)("span",{onClick:this.handleShowQR,children:Object(n.jsx)(ze.a,{})})]}),Object(n.jsx)("div",{className:"mypage-info-bio",children:Object(n.jsx)(jt,{children:this.props.bio})}),Object(n.jsxs)("div",{className:"mypage-info-tags",children:[Object(n.jsx)(dt.a,{icon:Object(n.jsx)(Ze.a,{}),color:"#55acee",children:this.props.regin}),Object(n.jsx)(dt.a,{icon:Object(n.jsx)(mt.a,{}),color:"#55acee",children:"00\u540e"})]}),Object(n.jsxs)("div",{className:"mypage-number-wrapper",children:[Object(n.jsx)(vt,{num:this.props.liked,discribe:"\u83b7\u8d5e"}),Object(n.jsx)(vt,{num:this.props.follow,discribe:"\u5173\u6ce8"}),Object(n.jsx)(vt,{num:this.props.follower,discribe:"\u7c89\u4e1d"})]})]})}}]),a}(i.a.Component),xt=function(e){Object(x.a)(a,e);var t=Object(k.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).state={userInfo:{userName:"tiktok",bgImg:"",avatar:"",regin:"",badgeItem:{},badgeurl:"",bio:"",liked:5,follow:5,follower:5},bgImg:"https://lh3.google.com/pw/ACtC-3d-0Y0LrGcsLGpyIE1aDGYp4NlkE9T9XCqRGjlw1arHe02U8xarBn1qQxusLMHLPUa1aoeMTTaiFwG8Q1KQPjS0brjyzR4=w973-h589-no?authuser=0"},n}return Object(O.a)(a,[{key:"componentDidMount",value:function(){this.fetchUserInfo()}},{key:"fetchUserInfo",value:function(){var e=this;ht({}).then((function(t){var a=t.data;a.success&&(a=a.data,localStorage.setItem("myInfo",JSON.stringify(a)),console.log(a),e.setState({userInfo:a}))})).catch((function(t){var a=localStorage.getItem("myInfo");a&&e.setState({userInfo:JSON.parse(a)}),console.error(t),Be.b.warning("\u4e0e\u670d\u52a1\u5668\u8fde\u63a5\u5931\u8d25",10)}))}},{key:"render",value:function(){return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)("div",{className:"mypage-wrapper",children:[Object(n.jsx)(bt,{bgImg:this.state.userInfo.bgImg}),Object(n.jsx)(Ot,Object(S.a)({},this.state.userInfo))]}),Object(n.jsx)("div",{className:"mypage-main",children:Object(n.jsx)(ft,{})})]})}}]),a}(i.a.Component),kt=(a(340),a(349)),yt=function(e){Object(x.a)(a,e);var t=Object(k.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).handleBadgeClick=function(){e.props.handleBadgeChange(e.props.id)},e}return Object(O.a)(a,[{key:"render",value:function(){return Object(n.jsxs)("div",{className:"badge-card ".concat(this.props.id===this.props.currentId?"sele":""),children:[Object(n.jsxs)("div",{className:"avatar",onClick:this.handleBadgeClick,children:[Object(n.jsx)("img",{className:"avatar-img",src:this.props.avatar}),Object(n.jsx)("img",{className:"avatar-ripon",src:this.props.badgeUrl})]}),Object(n.jsx)("div",{className:"badge-card-name",children:this.props.badgeName})]})}}]),a}(i.a.Component),wt=function(e){Object(x.a)(a,e);var t=Object(k.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).changeUserBadges=function(e){var t;n.setState({loading:!0}),(t={badge:e},C.post("/updateUser",t)).then((function(t){var a=t.data;a.success&&(a=a.data,n.setState({currentId:e}),Be.b.success("\u4fee\u6539\u5934\u50cf\u6846\u6210\u529f"))})).catch((function(e){Be.b.error("\u4fee\u6539\u7528\u6237\u4fe1\u606f\u5931\u8d25"),console.log(e)})).finally((function(){n.setState({loading:!1})}))},n.state={avatar:"",badgeSet:"",badges:[],currentId:"",loading:!0},n}return Object(O.a)(a,[{key:"componentDidMount",value:function(){this.fetchUserAvatar(),this.fetchUserBadges()}},{key:"fetchUserAvatar",value:function(){var e=this;ht({}).then((function(t){var a=t.data;a.success&&(a=a.data,e.setState({avatar:a.avatar,badgeSet:a.badgeurl,currentId:a.badgeItem._id}))})).catch((function(e){var t=localStorage.getItem("myInfo");t&&((t=JSON.parse(t))&&this.setState({avatar:t.avatar,badgeSet:t.badgeurl,currentId:t.badgeItem._id}),console.log(e))}))}},{key:"fetchUserBadges",value:function(){var e,t=this;(e={},C.post("/getUserBadges",e)).then((function(e){var a=e.data;a.success&&(a=a.data,localStorage.setItem("myBadges",JSON.stringify(a)),t.setState({badges:a}))})).catch((function(e){var a=localStorage.getItem("myBadges");a&&t.setState({badges:JSON.parse(a)}),console.error(e),Be.b.warning("\u4e0e\u670d\u52a1\u5668\u8fde\u63a5\u5931\u8d25,\u66f4\u6539\u7684\u4fe1\u606f\u53ef\u80fd\u4e0d\u4f1a\u4fdd\u5b58",5)})).finally((function(){t.setState({loading:!1})}))}},{key:"render",value:function(){var e=this;return Object(n.jsxs)("div",{children:[Object(n.jsx)(kt.a,{className:"site-page-header",title:"\u4fee\u6539\u4fe1\u606f",onBack:function(){},subTitle:this.state.loading?Object(n.jsxs)("div",{children:[Object(n.jsx)(Ge.a,{}),"\u52a0\u8f7d\u4e2d"]}):"\u4fee\u6539\u5934\u50cf\u6846"}),Object(n.jsx)("div",{className:"badge-wrapper",children:this.state.badges.map((function(t){return Object(n.jsx)(yt,{id:t._id,avatar:e.state.avatar,badgeUrl:t.badgeItem.badgeUrl,badgeName:t.badgeItem.badgeName,currentId:e.state.currentId,handleBadgeChange:e.changeUserBadges},t._id)}))})]})}}]),a}(i.a.Component);function Ct(){return Object(n.jsx)(o.a,{children:Object(n.jsx)("div",{children:Object(n.jsxs)(l.d,{children:[Object(n.jsx)(j,{exact:!0,path:"/",component:Ce}),Object(n.jsx)(j,{path:"/live",component:Te}),Object(n.jsx)(l.b,{path:"/ucenter",history:history,component:rt}),Object(n.jsx)(j,{path:"/mypage",component:xt}),Object(n.jsx)(l.b,{path:"/dev",component:he,videoId:"1612780375771"}),Object(n.jsx)(l.b,{path:"/myBadge",component:wt})]})})})}var Nt=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,370)).then((function(t){var a=t.getCLS,n=t.getFID,s=t.getFCP,i=t.getLCP,c=t.getTTFB;a(e),n(e),s(e),i(e),c(e)}))},St=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function It(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}r.a.render(Object(n.jsx)(i.a.StrictMode,{children:Object(n.jsx)(Ct,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");St?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):It(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):It(t,e)}))}}(),Nt()},61:function(e,t,a){e.exports={video:"VideoPlayer_video__1x-26",info:"VideoPlayer_info__p_zeF",author:"VideoPlayer_author__2x-K0",liveComents:"VideoPlayer_liveComents__2trM5",description:"VideoPlayer_description__2OJV5",tags:"VideoPlayer_tags__32zlE",tag:"VideoPlayer_tag__2jhPO",danmu:"VideoPlayer_danmu__1V5fP",action:"VideoPlayer_action__2CI0w",comment:"VideoPlayer_comment__se77N","comment-icon":"VideoPlayer_comment-icon__2VFvh","comment-number":"VideoPlayer_comment-number__K0paH"}},73:function(e,t,a){e.exports={top:"Top_top__2SUpi",left:"Top_left__J0r90",middle:"Top_middle__3q9H9",navbar:"Top_navbar__3WGJx","navbar-item":"Top_navbar-item__2ttu1","navbar-item-active":"Top_navbar-item-active__1lry4",right:"Top_right__2enh6","search-btn":"Top_search-btn__1BQUW"}}},[[341,1,2]]]);
//# sourceMappingURL=main.344dfbef.chunk.js.map